@{
    Layout = "_Layout";
    ViewData["Title"] = "Printer";
}

<h2>Select Printer</h2>

<select id="printerSelect">
    <option value="">-- Select Printer --</option>
</select>

<button onclick="printPdf()">Print</button>

<script>
    // Load printers (MVC URL)
    fetch('/Printer/GetPrinters')
        .then(res => res.json())
        .then(data => {
            const select = document.getElementById('printerSelect');
            data.forEach(p => {
                const option = document.createElement('option');
                option.value = p;
                option.text = p;
                select.appendChild(option);
            });
        });

    function printPdf() {
        const printer = document.getElementById('printerSelect').value;

        if (!printer) {
            alert('Please select a printer');
            return;
        }

        fetch('/Printer/PrintPdf', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(printer)
        })
        .then(res => res.text())
        .then(msg => alert(msg))
        .catch(err => alert('Error printing'));
    }
</script>